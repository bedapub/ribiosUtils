<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>KEEP ROWS WITH THE MAXIMUM STATISTIC — keepMaxStatRow • ribiosUtils</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="KEEP ROWS WITH THE MAXIMUM STATISTIC — keepMaxStatRow"><meta property="og:description" content="A common task in expression analysis is to collapse multiple features that
are mapped to the same gene by some statistic. This function does this job
by keeping the matrix row (normally features) with the higheest statistic
specified by the user."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ribiosUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bedapub/ribiosUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>KEEP ROWS WITH THE MAXIMUM STATISTIC</h1>
    <small class="dont-index">Source: <a href="https://github.com/bedapub/ribiosUtils/blob/master/R/keepMaxStatRow.R" class="external-link"><code>R/keepMaxStatRow.R</code></a></small>
    <div class="hidden name"><code>keepMaxStatRow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A common task in expression analysis is to collapse multiple features that
are mapped to the same gene by some statistic. This function does this job
by keeping the matrix row (normally features) with the higheest statistic
specified by the user.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">keepMaxStatRow</span><span class="op">(</span></span>
<span>  <span class="va">matrix</span>,</span>
<span>  <span class="va">keys</span>,</span>
<span>  keepNArows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stat <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rownames"</span>, <span class="st">"attribute"</span>, <span class="st">"discard"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-matrix">matrix<a class="anchor" aria-label="anchor" href="#arg-matrix"></a></dt>
<dd><p>A numeric matrix</p></dd>


<dt id="arg-keys">keys<a class="anchor" aria-label="anchor" href="#arg-keys"></a></dt>
<dd><p>A vector of character giving the keys the rows are mapped to. A
common scenario is that each row represents one probeset, while the vector
keys give the genes that the probesets are mapped to. Thus keys can be
redundant, namely multiple probesets can map to the same gene.</p></dd>


<dt id="arg-keepnarows">keepNArows<a class="anchor" aria-label="anchor" href="#arg-keepnarows"></a></dt>
<dd><p>Logical, whether rows with <code>NA</code> as their keys should
be kept (<code>TRUE</code>) or should be discarded (<code>FALSE</code>)</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>The function to calculate the univariate statistic. By default
the <code>NA</code>-robust mean is used.</p></dd>


<dt id="arg-levels">levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>How should the information of the levels of keys, e.g. unique
keys, be kept. <code>dicard</code> will discard this information, <code>rownames</code>
will make the unique keys (potentially with <code>NA</code>s) as row names of the
output matrix, and <code>attribute</code> will append an attribute named
<code>levels</code> to the output matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed to the <code>stat</code> function</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric matrix with rows mapped to unique keys, selected by the
maximum statistics. See examples below</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>isMaxStatRow</code> returns a logical vector, with rows with maximal
statistics each key as <code>TRUE</code> and otherwise as <code>FALSE</code>.
<code>keepMaxStatRowInd</code> returns the integer indices of such rows. Finally
<code>keepMaxStatRow</code> returns the resulting matrices.</p>
<p>For use see examples</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jitao David Zhang &lt;jitao_david.zhang@roche.com&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">myFun1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">myFun2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">5</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">keys1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE  TRUE  TRUE</span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 4</span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A    7    9    5    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B    0    1    4    3</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span>, levels<span class="op">=</span><span class="st">"discard"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span>, levels<span class="op">=</span><span class="st">"attribute"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">5</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">4</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">3.1</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">9</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">1</span>,<span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                 <span class="cn">NA</span>, <span class="fl">4</span>, <span class="fl">3</span>,<span class="cn">NA</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">keys2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"D"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE  TRUE</span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 4 7 9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A    7    9    5    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B    0    1    4    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    8    9    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D   NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A       7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B       0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;NA&gt;    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;NA&gt;    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C       8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D      NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span>, levels<span class="op">=</span><span class="st">"discard"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D    0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G    8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I   NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span>, levels<span class="op">=</span><span class="st">"attribute"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D    0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G    8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I   NA    4    3   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"levels")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A" "B" NA  NA  "C" "D"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jitao David Zhang, Clemens Broger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

