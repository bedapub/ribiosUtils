<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>KEEP ROWS WITH THE MAXIMUM STATISTIC — keepMaxStatRow • ribiosUtils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="KEEP ROWS WITH THE MAXIMUM STATISTIC — keepMaxStatRow"><meta name="description" content="A common task in expression analysis is to collapse multiple features that
are mapped to the same gene by some statistic. This function does this job
by keeping the matrix row (normally features) with the higheest statistic
specified by the user."><meta property="og:description" content="A common task in expression analysis is to collapse multiple features that
are mapped to the same gene by some statistic. This function does this job
by keeping the matrix row (normally features) with the higheest statistic
specified by the user."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ribiosUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bedapub/ribiosUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>KEEP ROWS WITH THE MAXIMUM STATISTIC</h1>
      <small class="dont-index">Source: <a href="https://github.com/bedapub/ribiosUtils/blob/devel/R/keepMaxStatRow.R" class="external-link"><code>R/keepMaxStatRow.R</code></a></small>
      <div class="d-none name"><code>keepMaxStatRow.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A common task in expression analysis is to collapse multiple features that
are mapped to the same gene by some statistic. This function does this job
by keeping the matrix row (normally features) with the higheest statistic
specified by the user.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">keepMaxStatRow</span><span class="op">(</span></span>
<span>  <span class="va">matrix</span>,</span>
<span>  <span class="va">keys</span>,</span>
<span>  keepNArows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stat <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rownames"</span>, <span class="st">"attribute"</span>, <span class="st">"discard"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matrix">matrix<a class="anchor" aria-label="anchor" href="#arg-matrix"></a></dt>
<dd><p>A numeric matrix</p></dd>


<dt id="arg-keys">keys<a class="anchor" aria-label="anchor" href="#arg-keys"></a></dt>
<dd><p>A vector of character giving the keys the rows are mapped to. A
common scenario is that each row represents one probeset, while the vector
keys give the genes that the probesets are mapped to. Thus keys can be
redundant, namely multiple probesets can map to the same gene.</p></dd>


<dt id="arg-keepnarows">keepNArows<a class="anchor" aria-label="anchor" href="#arg-keepnarows"></a></dt>
<dd><p>Logical, whether rows with <code>NA</code> as their keys should
be kept (<code>TRUE</code>) or should be discarded (<code>FALSE</code>)</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>The function to calculate the univariate statistic. By default
the <code>NA</code>-robust mean is used.</p></dd>


<dt id="arg-levels">levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>How should the information of the levels of keys, e.g. unique
keys, be kept. <code>dicard</code> will discard this information, <code>rownames</code>
will make the unique keys (potentially with <code>NA</code>s) as row names of the
output matrix, and <code>attribute</code> will append an attribute named
<code>levels</code> to the output matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed to the <code>stat</code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric matrix with rows mapped to unique keys, selected by the
maximum statistics. See examples below</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>isMaxStatRow</code> returns a logical vector, with rows with maximal
statistics each key as <code>TRUE</code> and otherwise as <code>FALSE</code>.
<code>keepMaxStatRowInd</code> returns the integer indices of such rows. Finally
<code>keepMaxStatRow</code> returns the resulting matrices.</p>
<p>For use see examples</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jitao David Zhang &lt;jitao_david.zhang@roche.com&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">myFun1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">myFun2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">5</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">keys1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE  TRUE  TRUE</span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 4</span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A    7    9    5    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B    0    1    4    3</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span>, levels<span class="op">=</span><span class="st">"discard"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">keys1</span>, stat<span class="op">=</span><span class="st">"myFun2"</span>, levels<span class="op">=</span><span class="st">"attribute"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(stat, envir = parent.frame()):</span> object 'myFun2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">5</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">4</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">3.1</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">9</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">1</span>,<span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                 <span class="cn">NA</span>, <span class="fl">4</span>, <span class="fl">3</span>,<span class="cn">NA</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">keys2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"D"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">isMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE  TRUE</span>
<span class="r-in"><span><span class="fu">keepMaxStatRowInd</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 4 7 9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">FALSE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A    7    9    5    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B    0    1    4    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    8    9    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D   NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A       7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B       0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;NA&gt;    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;NA&gt;    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C       8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D      NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span>, levels<span class="op">=</span><span class="st">"discard"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D    0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G    8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I   NA    4    3   NA</span>
<span class="r-in"><span><span class="fu">keepMaxStatRow</span><span class="op">(</span><span class="va">mat2</span>, <span class="va">keys2</span>, keepNArows<span class="op">=</span><span class="cn">TRUE</span>, stat<span class="op">=</span><span class="va">myFun1</span>, levels<span class="op">=</span><span class="st">"attribute"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C    7    9    5  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D    0    1    4  3.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E    4    0   -1  3.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F    9    4   -3  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G    8    9    1  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I   NA    4    3   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"levels")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A" "B" NA  NA  "C" "D"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jitao David Zhang, Clemens Broger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

